@using TinyShop.Models.ViewModels;
@model OrderViewModel

<h2>Check out now</h2>
<p>Please enter your details, and we'll ship your goods right away.</p>
<div asp-validation-summary="All" class="text-danger"></div>
<form asp-action="Checkout" method="post">
    <h3>Ship to</h3>
    <div class="form-group">
        <label asp-for="TheOrder.TheCustomer.FirstName" class="control-label"></label>
        <input asp-for="TheOrder.TheCustomer.FirstName" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.TheCustomer.LastName" class="control-label"></label>
        <input asp-for="TheOrder.TheCustomer.LastName" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.TheCustomer.MiddleName" class="control-label"></label>
        <input asp-for="TheOrder.TheCustomer.MiddleName" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.TheCustomer.Phone" class="control-label"></label>
        <input asp-for="TheOrder.TheCustomer.Phone" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.TheCustomer.Email" class="control-label"></label>
        <input asp-for="TheOrder.TheCustomer.Email" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.RegionId" class="control-label"></label>
        <select id="region" asp-for="TheOrder.RegionId" class="form-control"
                asp-items='@new SelectList(Model.Regions, "Id" , "Name")'></select>
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.CityId" class="control-label"></label>
        <select id="city" asp-for="TheOrder.CityId" class="form-control"></select>
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.WarehouseId" class="control-label"></label>
        <select id="warehouse" asp-for="TheOrder.WarehouseId" class="form-control"></select>
    </div>
    <div class="form-group">
        <div class="form-check">
            <input class="form-check-input" type="radio" name="payment" id="postPay">
            <label class="form-check-label" for="postPay">
                Post pay
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="radio" name="payment" id="payByCard" checked>
            <label class="form-check-label" for="payByCard">
                Pay by card
            </label>
        </div>
    </div>
    <div class="form-group">
        <label asp-for="TheOrder.Comments" class="control-label"></label>
        <input asp-for="TheOrder.Comments" class="form-control" />
    </div>
    <div class="form-group">
        <input class="btn btn-primary" type="submit" value="Complete Order" />
    </div>
</form>

@section Scripts {
    <script>
        $(document).ready(function () {
            $("#region").change(function () {
                var url = "/Order/GetCitiesByRegion/" + $("#region").val();
                $.getJSON(url, function (data) {                                        
                    $("#city").empty();
                    $.each(data, function (index, row) {                                                
                        $("#city").append("<option value='" + row.id + "'>" + row.name + "</option>");
                    });
                });
            });
        });
        $(document).ready(function () {
            $("#city").change(function () {
                var url = "/Order/GetWarehousesByCity/" + $("#city").val();
                $.getJSON(url, function (data) {
                    $("#warehouse").empty();
                    $.each(data, function (index, row) {
                        $("#warehouse").append("<option value='" + row.id + "'>" + row.name + "</option>");
                    });
                });
            });
        });
    </script>
}